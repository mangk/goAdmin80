/*! 
 Build based on gin-vue-admin 
 Time : 1691137549000 */
import{a,Q as e,o as t,d as l,e as s,g as o,F as n,y as i,j as r,w as u,k as p,t as c,X as d,Y as m,m as g,n as v,q as f,s as h,E as w,Z as y,_,$ as j,a0 as b,a1 as k}from"./80index.dd9a9de9.js";import"./80loading.4ed993c7.js";import"./80pagination.4ed993c7.js";import"./80input.4ed993c7.js";import"./80tag.4ed993c7.js";import"./80select.4ed993c7.js";import"./80scrollbar.4ed993c7.js";import"./80popper.4ed993c7.js";import"./80table-column.4ed993c7.js";import"./80checkbox.4ed993c7.js";import"./80tooltip.4ed993c7.js";import"./80form-item.4ed993c7.js";import"./80button.4ed993c7.js";import{U as x,u as C,g as U,d as z,e as E}from"./80image.a394e5bf.js";import{C as B}from"./80index.f57ace25.js";import{f as O}from"./80format.84ea4d19.js";import{W as S}from"./80warningBar.81c61060.js";import{_ as T}from"./80_plugin-vue_export-helper.1b428a4d.js";import"./80progress.4ed993c7.js";import"./80icon.4ed993c7.js";import"./80warningBar.vue_vue_type_style_index_0_scoped_a7c6b110_lang.4ed993c7.js";const V=(a,e)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0,t.width,t.height);var l=a.toDataURL("image/png"),s=document.createElement("a"),o=new MouseEvent("click");s.download=e||"photo",s.href=l,s.dispatchEvent(o)},t.src=a},I={class:"gva-table-box"},L={class:"gva-btn-list"},M=["onClick"],A={class:"gva-pagination"},D={name:"Upload"},F=T(Object.assign(D,{setup(T){const D=a("");a("");const F=a(1),P=a(0),Q=a(10),R=a({}),W=a([]),X=a({}),q=a=>{Q.value=a,J()},G=a=>{F.value=a,J()};(async()=>{const a=await C();0===a.code&&(X.value=a.data)})();const J=async()=>{const a=await U({page:F.value,pageSize:Q.value,...R.value});0===a.code&&(W.value=a.data.list,P.value=a.data.total,F.value=a.data.page,Q.value=a.data.pageSize)};J();return(a,C)=>{const U=v,T=f,K=h,N=w,Y=y,Z=_,$=j,H=b,aa=k;return e((t(),l("div",null,[s("div",I,[o(S,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),s("div",L,[(t(!0),l(n,null,i(X.value,(a=>(t(),r(x,{key:a.driver,imageUrl:D.value,"onUpdate:imageUrl":C[0]||(C[0]=a=>D.value=a),"file-size":a.limit,"btn-name":a.name,oss:a.driver,class:"upload-btn",onOnSuccess:J},null,8,["imageUrl","file-size","btn-name","oss"])))),128)),o(N,{ref:"searchForm",inline:!0,model:R.value},{default:u((()=>[o(T,{label:""},{default:u((()=>[o(U,{modelValue:R.value.keyword,"onUpdate:modelValue":C[1]||(C[1]=a=>R.value.keyword=a),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),o(T,null,{default:u((()=>[o(K,{type:"primary",icon:"search",onClick:J},{default:u((()=>[p("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),o($,{data:W.value},{default:u((()=>[o(Y,{align:"left",label:"预览",width:"100"},{default:u((a=>[o(B,{"pic-type":"file","pic-src":"/"==a.row.url[0]?a.row.url:"https://"+a.row.url+"/thumbnail"},null,8,["pic-src"])])),_:1}),o(Y,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:u((a=>[s("div",null,c(d(O)(a.row.ut)),1)])),_:1}),o(Y,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:u((a=>[s("div",{class:"name",onClick:e=>(async a=>{m.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:a.name}).then((async({value:e})=>{a.name=e,0===(await E(a)).code&&(g({type:"success",message:"编辑成功!"}),J())})).catch((()=>{g({type:"info",message:"取消修改"})}))})(a.row)},c(a.row.name),9,M)])),_:1}),o(Y,{align:"left",label:"链接",prop:"url","min-width":"300"}),o(Y,{align:"left",label:"标签",prop:"tag",width:"100"},{default:u((a=>[o(Z,{type:"jpg"===a.row.tag?"primary":"success","disable-transitions":""},{default:u((()=>[p(c(a.row.tag),1)])),_:2},1032,["type"])])),_:1}),o(Y,{align:"left",label:"操作",width:"160"},{default:u((a=>[o(K,{icon:"download",type:"primary",link:"",onClick:e=>{return(t=a.row).url.indexOf("http://")>-1||t.url.indexOf("https://"),void V(t.url,t.name);var t}},{default:u((()=>[p("下载")])),_:2},1032,["onClick"]),o(K,{icon:"delete",type:"primary",link:"",onClick:e=>(async a=>{m.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await z(a)).code&&(g({type:"success",message:"删除成功!"}),1===W.value.length&&F.value>1&&F.value--,J())})).catch((()=>{g({type:"info",message:"已取消删除"})}))})(a.row)},{default:u((()=>[p("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),s("div",A,[o(H,{"current-page":F.value,"page-size":Q.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:P.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:G,onSizeChange:q},null,8,["current-page","page-size","total"])])])])),[[aa,a.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-6cdac069"]]);export{F as default};
