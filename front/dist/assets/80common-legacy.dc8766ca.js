/*! 
 Build based on gin-vue-admin 
 Time : 1685586964000 */
!function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?a:String(a)),r)}var i,a}System.register(["./80index-legacy.6cf2c604.js","./80progress-legacy.518b8698.js","./80button-legacy.518b8698.js","./80_plugin-vue_export-helper-legacy.c6aa7c23.js"],(function(t,n){"use strict";var r,i,a,o,l,u,s,c,f,d,p,h,m;return{setters:[function(e){r=e.O,i=e.a,a=e.b,o=e.o,l=e.d,u=e.f,s=e.w,c=e.k,f=e.X,d=e.m,p=e.s,h=e.aM},null,null,function(e){m=e._}],execute:function(){t("g",(function(e){return r({url:"/fileUploadAndDownload/getFileList",method:"post",data:e})})),t("d",(function(e){return r({url:"/fileUploadAndDownload/deleteFile",method:"post",data:e})})),t("e",(function(e){return r({url:"/fileUploadAndDownload/editFileName",method:"post",data:e})}));var n=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.file=e,this.fileSize=n,this.maxWH=r}var n,r,i;return n=t,(r=[{key:"compress",value:function(){var e=this,t=this.file.type,n=this.file.size/1024;return new Promise((function(r){var i=new FileReader;i.readAsDataURL(e.file),i.onload=function(){var a=document.createElement("canvas"),o=document.createElement("img");o.src=i.result,o.onload=function(){var i=a.getContext("2d"),l=e.dWH(o.width,o.height,e.maxWH);a.width=l.width,a.height=l.height,i.clearRect(0,0,a.width,a.height),i.drawImage(o,0,0,a.width,a.height);var u=a.toDataURL(t,.9),s=e.fileSizeKB(u);s>e.fileSize&&console.log("图片尺寸太大!"+n+" >> "+s);var c=e.dataURLtoBlob(u,t),f=new File([c],e.file.name);r(f)}}}))}},{key:"dWH",value:function(e,t,n){var r={width:e,height:t};return Math.max(e,t)>n?e>t?(r.width=n,r.height=Math.round(t*(n/e)),r):(r.height=n,r.width=Math.round(e*(n/t)),r):r}},{key:"fileSizeKB",value:function(e){return Math.round(3*e.split(",")[1].length/4/1024)}},{key:"dataURLtoBlob",value:function(e,t){for(var n=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(n.length),a=new Uint8Array(i),o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return t&&(r=t),new Blob([i],{type:r,lastModifiedDate:new Date})}}])&&e(n.prototype,r),i&&e(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(),g={name:"UploadImage",methods:{}},v=(t("U",m(Object.assign(g,{props:{imageUrl:{type:String,default:""},fileSize:{type:Number,default:2048},maxWH:{type:Number,default:1920}},emits:["on-success"],setup:function(e,t){var r=t.emit,m=e,g=i("/_sys"),v=a(),y=function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;if(!t&&!r)return d.error("上传头像图片只能是 jpg或png 格式!"),!1;var i=e.size/1024<m.fileSize;return i||new n(e,m.fileSize,m.maxWH).compress()},w=function(e){var t=e.data;t.file&&r("on-success",t.file.url)};return function(e,t){var n=p,r=h;return o(),l("div",null,[u(r,{action:"".concat(g.value,"/fileUploadAndDownload/upload"),headers:{Authorization:"Bearer "+f(v).token},"show-file-list":!1,"on-success":w,"before-upload":y,multiple:!1},{default:s((function(){return[u(n,{type:"primary"},{default:s((function(){return[c("压缩上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}),[["__scopeId","data-v-29627731"]])),{name:"UploadCommon",methods:{}});t("_",Object.assign(v,{emits:["on-success"],setup:function(e,t){var n=t.emit,r=i("/_sys"),m=a(),g=i(!1),v=function(e){g.value=!0;var t="image/jpeg"===e.type,n="image/png"===e.type,r=e.size/1024/1024<.5;return t||n||(d.error("上传图片只能是 jpg或png 格式!"),g.value=!1),r||(d.error("未压缩的上传图片大小不能超过 500KB，请使用压缩上传"),g.value=!1),(n||t)&&r},y=function(e){var t=e.data;t.file&&n("on-success",t.file.url)},w=function(){d({type:"error",message:"上传失败"}),g.value=!1};return function(e,t){var n=p,i=h;return o(),l("div",null,[u(i,{action:"".concat(r.value,"/fileUploadAndDownload/upload"),"before-upload":v,headers:{Authorization:"Bearer "+f(m).token},"on-error":w,"on-success":y,"show-file-list":!1,class:"upload-btn"},{default:s((function(){return[u(n,{type:"primary"},{default:s((function(){return[c("普通上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}))}}}))}();
