/*! 
 Build based on gin-vue-admin 
 Time : 1684300488000 */
import{N as e,r as a,O as t,o,c as l,d as s,e as r,w as u,j as d,t as n,y as i,aA as c,aB as p,l as m,aC as y,m as h,q as f,ax as v,Y as k,_ as w,a2 as b}from"./80index.a465723e.js";import"./80dialog.4ed993c7.js";import"./80overlay.4ed993c7.js";import"./80table-column.4ed993c7.js";import"./80checkbox.4ed993c7.js";import"./80tag.4ed993c7.js";import"./80tooltip.4ed993c7.js";import"./80popper.4ed993c7.js";import"./80scrollbar.4ed993c7.js";import"./80tree.4ed993c7.js";import"./80button.4ed993c7.js";import"./80input.4ed993c7.js";import{u as j}from"./80authority.77abe6b8.js";import{_ as g}from"./80_plugin-vue_export-helper.1b428a4d.js";const I={class:"clearfix sticky-button"},_={class:"tree-content"},x={class:"custom-tree-node"},C={class:"dialog-footer"},R={name:"Menus"},N=g(Object.assign(R,{props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(g,{expose:R,emit:N}){const V=g,A=a(""),O=a([]),D=a([]),B=a(!1),E=a({children:"children",label:function(e){return e.meta.title}});(async()=>{const e=await c(!0,!0);O.value=e.data.list;const a=(await p({authorityId:V.row.authorityId})).data,t=[];a.forEach((e=>{a.some((a=>a.parentId===e.id))||t.push(Number(e.id))})),D.value=t,console.log(t)})();const M=()=>{B.value=!0},S=a(null),T=async()=>{const e=S.value.getCheckedNodes(!1,!0);0===(await y({menus:e,authorityId:V.row.authorityId})).code&&m({type:"success",message:"菜单设置成功!"})};R({enterAndNext:()=>{T()},needConfirm:B});const U=a(!1),Y=a([]),q=a([]),G=a();const P=e=>{q.value=e},Q=()=>{U.value=!1},X=async()=>{const a=q.value.map((e=>e.ID));var t;0===(await(t={menuID:"",selected:a,authorityId:V.row.authorityId},e({url:"/authorityBtn/setAuthorityBtn",method:"post",data:t}))).code&&(m({type:"success",message:"设置成功"}),U.value=!1)},z=(e,a)=>!e||-1!==a.meta.title.indexOf(e);return t(A,(e=>{S.value.filter(e)})),(e,a)=>{const t=h,c=f,p=v,y=k,R=w,B=b;return o(),l("div",null,[s("div",I,[r(t,{modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),class:"fitler",placeholder:"筛选"},null,8,["modelValue"]),r(c,{class:"fl-right",type:"primary",onClick:T},{default:u((()=>[d("确 定")])),_:1})]),s("div",_,[r(p,{ref_key:"menuTree",ref:S,data:O.value,"default-checked-keys":D.value,props:E.value,"default-expand-all":"","highlight-current":"","node-key":"id","show-checkbox":"","filter-node-method":z,onCheck:M},{default:u((({node:e,data:a})=>[s("span",x,[s("span",null,n(e.label),1),s("span",null,[r(c,{type:"primary",link:"",style:i({color:g.row.defaultRouter===a.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>(async e=>{const a=await j({authorityId:V.row.authorityId,AuthorityName:V.row.authorityName,parentId:V.row.parentId,defaultRouter:e.name});0===a.code&&(m({type:"success",message:"设置成功"}),N("changeRow","defaultRouter",a.data.authority.defaultRouter))})(a)},{default:u((()=>[d(n(g.row.defaultRouter===a.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])])])])),_:1},8,["data","default-checked-keys","props"])]),r(B,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),title:"分配按钮","destroy-on-close":""},{footer:u((()=>[s("div",C,[r(c,{onClick:Q},{default:u((()=>[d("取 消")])),_:1}),r(c,{type:"primary",onClick:X},{default:u((()=>[d("确 定")])),_:1})])])),default:u((()=>[r(R,{ref_key:"btnTableRef",ref:G,data:Y.value,"row-key":"ID",onSelectionChange:P},{default:u((()=>[r(y,{type:"selection",width:"55"}),r(y,{label:"按钮名称",prop:"name"}),r(y,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-37c753b4"]]);export{N as default};
