/*! 
 Build based on gin-vue-admin 
 Time : 1684380092000 */
import{a as e,o as a,i as l,w as t,f as s,e as o,k as r,d as i,F as n,y as u,t as m,Y as p,m as c,n as d,q as v,s as g,E as y,B as f,aP as j,a0 as _,ar as b}from"./80index.d39802eb.js";import"./80drawer.4ed993c7.js";import"./80overlay.4ed993c7.js";import"./80pagination.4ed993c7.js";import"./80input.4ed993c7.js";import"./80tag.4ed993c7.js";import"./80select.4ed993c7.js";import"./80scrollbar.4ed993c7.js";import"./80popper.4ed993c7.js";import"./80icon.4ed993c7.js";import"./80form-item.4ed993c7.js";import"./80button.4ed993c7.js";import{_ as x,U as C,g as h,e as k}from"./80common.a625b89d.js";import{W as w}from"./80warningBar.6e2de832.js";const U={class:"gva-btn-list"},z={class:"media"},S={class:"header-img-box-list"},V={class:"header-img-box-list"},B=o("picture",null,null,-1),O=["onClick"],E={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(E,{expose:I,emit:P}){const T=e(""),F=e(""),K=e({}),M=e(1),W=e(0),Y=e(20),q=e=>{Y.value=e,G()},D=e=>{M.value=e,G()},L=e(!1),N=e([]),A=e("/_sys/"),G=async()=>{const e=await h({page:M.value,pageSize:Y.value,...K.value});0===e.code&&(N.value=e.data.list,W.value=e.data.total,M.value=e.data.page,Y.value=e.data.pageSize,L.value=!0)};return I({open:G}),(e,h)=>{const I=d,H=v,J=g,Q=y,R=f,X=j,Z=_,$=b;return a(),l($,{modelValue:L.value,"onUpdate:modelValue":h[3]||(h[3]=e=>L.value=e),title:"媒体库",size:"650px"},{default:t((()=>[s(w,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),o("div",U,[s(x,{imageCommon:F.value,"onUpdate:imageCommon":h[0]||(h[0]=e=>F.value=e),class:"upload-btn-media-library",onOnSuccess:G},null,8,["imageCommon"]),s(C,{imageUrl:T.value,"onUpdate:imageUrl":h[1]||(h[1]=e=>T.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:G},null,8,["imageUrl"]),s(Q,{ref:"searchForm",inline:!0,model:K.value},{default:t((()=>[s(H,{label:""},{default:t((()=>[s(I,{modelValue:K.value.keyword,"onUpdate:modelValue":h[2]||(h[2]=e=>K.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),s(H,null,{default:t((()=>[s(J,{type:"primary",icon:"search",onClick:G},{default:t((()=>[r("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",z,[(a(!0),i(n,null,u(N.value,((e,r)=>(a(),i("div",{key:r,class:"media-box"},[o("div",S,[(a(),l(X,{key:r,src:e.url&&"http"!==e.url.slice(0,4)?A.value+e.url:e.url,onClick:a=>{return l=e.url,t=E.target,s=E.targetKey,t&&s&&(t[s]=l),P("enterImg",l),void(L.value=!1);var l,t,s}},{error:t((()=>[o("div",V,[s(R,null,{default:t((()=>[B])),_:1})])])),_:2},1032,["src","onClick"]))]),o("div",{class:"img-title",onClick:a=>(async e=>{p.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await k(e)).code&&(c({type:"success",message:"编辑成功!"}),G())})).catch((()=>{c({type:"info",message:"取消修改"})}))})(e)},m(e.name),9,O)])))),128))]),s(Z,{"current-page":M.value,"page-size":Y.value,total:W.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:D,onSizeChange:q},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{E as _};
